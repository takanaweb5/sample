<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Sample</title>
<link href="https://vjs.zencdn.net/7.10.2/video-js.css" rel="stylesheet" />
<!-- <link href="https://vjs.zencdn.net/7.10.2/vjs-time-divider" rel="stylesheet" /> -->
<script src="https://vjs.zencdn.net/7.10.2/video.min.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/6.3.3/video.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-hls/5.12.2/videojs-contrib-hls.min.js"></script> -->
<script>
    var MySepcialButton;
    const url ='file://ls-chl95/share/Disney/youtube/Peppa%20Pig%20-%20Official%20Channel(2020-01-03)Peppa%20Pig%20Official%20Channel%20%EF%BD%9C%20Peppa%20Pig%20Plays%20with%20Penguins%20at%20the%20South%20Pole%20.mp4';
    let player;
    // window.onload = function() {
    changeRate = function(e) {
        let rate = 0.1;
        if (e.currentTarget.name == 'slow') {
            rate = -rate;
        }

        document.getElementsByTagName('video')[0].playbackRate = 
            (document.getElementsByTagName('video')[0].playbackRate+rate).toFixed(1);
    };
    onOpen = function() {
        
        // const url =document.getElementById("url").value;
        //1.0～5.0まで0.2きざみの配列を作成
        const rates = [...Array(1)].map((_, i) => (1 + i*0.2).toFixed(1));
        player = videojs('my-player', { playbackRates: rates,
            sources: [{
            src: url,
            type: 'video/mp4'
         }],
         controlBar: {
            progressControl: {
                keepTooltipsInside: true
            }
        }
        // controlBar: {
        //     CurrentTimeDisplay: true, 
        //     TimeDivider: true,
        //     DurationDisplay: true,
        //     // muteToggle: true,
        //     volumePanel: {
        //         inline: false
        // }
//   }
        });
        // Get a component to subclass
        var VjsButton = videojs.getComponent('Button');
        // Subclass the component (see 'extend' doc for more info)
        MySepcialButton = videojs.extend(VjsButton, {    constructor: function(player) {
      videojs.getComponent("Button").apply(this, arguments);
      this.controlText("Rotate");
      this.player = player;
    },
    handleClick: function() {
        document.getElementsByTagName('video')[0].playbackRate += 0.1;
    }
});
        // Register the new component
        VjsButton.registerComponent('MySepcialButton', MySepcialButton);
        // (optionally) add the new component as a default player child
        // player.addChild('MySepcialButton');
        // player.getChild("controlBar").addChild("MySepcialButton", {}, 11);

        // var d1 = document.createElement("text");
        // d1.style.cssText = "margin-right:12px;font-size:150%;";
        // d1.innerHTML = "速度:";
        // player.appendChild(d1);

        var btnSlow = document.createElement("button");
        // btnSlow.style.cssText = "margin-right:12px;font-size:100%;";
        btnSlow.innerHTML = "<<";
        btnSlow.name = "slow";
        btnSlow.onclick = changeRate;
        // player.getChild("controlBar").el().appendChild(btnSlow);    

        var btnfast = document.createElement("button");
        var a = player.getChild("controlBar").el().style.csstext;
        console.log(a);
        btnfast.innerHTML = ">>";
        btnfast.onclick = changeRate;
        btnfast.name = "fast";
        // player.getChild("controlBar").el().appendChild(btnfast);    
    
        var txtSpeed = document.createElement("text");
        // txtSpeed.style.cssText = "margin-right:12px;font-size:100%;";
        txtSpeed.innerText = "1.0x";
        txtSpeed.id = "speed";
        // player.getChild("controlBar").el().appendChild(txtSpeed);    

        let Component = videojs.getComponent('Component');
        let com = new Component(player);
        com.el().appendChild(btnSlow);
        com.el().appendChild(txtSpeed);
        com.el().appendChild(btnfast);
        player.getChild("controlBar").addChild(com,{},1);
    }
// https://codepen.io/jiyangg/pen/YEJdvY

</script>
</head>
<body>
    <button type="button" onClick="onOpen()">開く</button>
    <button type="button" onClick="onClick()">テスト</button>
    <textarea id="url"></textarea>
    <video id="my-player" class="video-js vjs-big-play-centered" controls preload="auto" 
        width="640"
        height="300"
        >
    </video>
</body>
</html>


